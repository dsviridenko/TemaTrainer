# TemaTrainer

**TemaTrainer** — компактная реализация Trainer'а для fine-tuning LLM с памятью-оптимизированным Teacher EMA (TEMA).  
Основная идея: поддерживать EMA - учителя только для обучаемых адаптеров (LoRA), чтобы:

- экономить GPU память (нет полной копии модели),
- стабилизировать обучение,
- легко интегрироваться с PEFT/LoRA и trl.SFTTrainer.

## Особенности

- EMA только по `requires_grad` параметрам (обычно LoRA).
- Совместимость с 4-bit (bitsandbytes) моделями, если основная (base) модель остаётся замороженной и LoRA активен.

## Установка

Рекомендуется создавать виртуальное окружение (venv / conda):

```bash
pip install -r requirements.txt
